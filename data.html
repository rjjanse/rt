<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.306">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./creating.html">Getting started with R</a></li><li class="breadcrumb-item"><a href="./data.html">Data</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Home</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Set-up</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RStudio</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Getting started with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./creating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating and storing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./accessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accessing and manipulating data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Going further with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">functions.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">looping.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Doing and reporting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">regression.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">imputation.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">plotting.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">table1.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">rmarkdown.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Practical applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">prediction.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">competing_risks.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">confounding.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">agreement.qmd</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Recap</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">summary.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">further_resources.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">rython.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">slow.qmd</span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#why-we-need-to-load-data" id="toc-why-we-need-to-load-data" class="nav-link active" data-scroll-target="#why-we-need-to-load-data">Why we need to load data</a></li>
  <li><a href="#the-basics" id="toc-the-basics" class="nav-link" data-scroll-target="#the-basics">The basics</a>
  <ul>
  <li><a href="#working-directionary" id="toc-working-directionary" class="nav-link" data-scroll-target="#working-directionary">Working directionary</a></li>
  <li><a href="#file" id="toc-file" class="nav-link" data-scroll-target="#file">File</a></li>
  <li><a href="#tilde-expansion" id="toc-tilde-expansion" class="nav-link" data-scroll-target="#tilde-expansion">Tilde expansion</a></li>
  </ul></li>
  <li><a href="#delimited-data-with-base-and-readr" id="toc-delimited-data-with-base-and-readr" class="nav-link" data-scroll-target="#delimited-data-with-base-and-readr">Delimited data with {base} and {readr}</a></li>
  <li><a href="#excel-files" id="toc-excel-files" class="nav-link" data-scroll-target="#excel-files">Excel files</a></li>
  <li><a href="#spss-sas-and-stata-data" id="toc-spss-sas-and-stata-data" class="nav-link" data-scroll-target="#spss-sas-and-stata-data">SPSS, SAS, and Stata data</a></li>
  <li><a href="#foreign" id="toc-foreign" class="nav-link" data-scroll-target="#foreign">Foreign</a></li>
  <li><a href="#making-your-life-easier" id="toc-making-your-life-easier" class="nav-link" data-scroll-target="#making-your-life-easier">Making your life easier</a>
  <ul>
  <li><a href="#point-and-click-import" id="toc-point-and-click-import" class="nav-link" data-scroll-target="#point-and-click-import">Point-and-click import</a></li>
  <li><a href="#rio" id="toc-rio" class="nav-link" data-scroll-target="#rio">Rio</a></li>
  </ul></li>
  <li><a href="#rdata-and-.rda" id="toc-rdata-and-.rda" class="nav-link" data-scroll-target="#rdata-and-.rda">.Rdata and .Rda</a></li>
  <li><a href="#projectiles-and-carpeting" id="toc-projectiles-and-carpeting" class="nav-link" data-scroll-target="#projectiles-and-carpeting">Projectiles and carpeting</a>
  <ul>
  <li><a href="#arrow-formerly-known-as-feather" id="toc-arrow-formerly-known-as-feather" class="nav-link" data-scroll-target="#arrow-formerly-known-as-feather">Arrow (formerly known as Feather)</a></li>
  <li><a href="#parquet" id="toc-parquet" class="nav-link" data-scroll-target="#parquet">Parquet</a></li>
  </ul></li>
  <li><a href="#sql" id="toc-sql" class="nav-link" data-scroll-target="#sql">SQL</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul>
  <li><a href="#downloading-data" id="toc-downloading-data" class="nav-link" data-scroll-target="#downloading-data">0. Downloading data</a></li>
  <li><a href="#loading-new-data" id="toc-loading-new-data" class="nav-link" data-scroll-target="#loading-new-data">1. Loading new data</a></li>
  <li><a href="#storing-data" id="toc-storing-data" class="nav-link" data-scroll-target="#storing-data">2. Storing data</a></li>
  </ul></li>
  <li><a href="#next-topic" id="toc-next-topic" class="nav-link" data-scroll-target="#next-topic">Next topic</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="why-we-need-to-load-data" class="level2">
<h2 class="anchored" data-anchor-id="why-we-need-to-load-data">Why we need to load data</h2>
<p>We have already seen how to create data from scratch, but it is more likely that your data is not created that way. Instead, most data is stored in electronic data capture systems. These systems can then return files which allow the data to be read into statistical programs. This data may come in multiple formats and here we will discuss how to read these different formats into your R Global Environment.</p>
</section>
<section id="the-basics" class="level2">
<h2 class="anchored" data-anchor-id="the-basics">The basics</h2>
<section id="working-directionary" class="level3">
<h3 class="anchored" data-anchor-id="working-directionary">Working directionary</h3>
<p>When we want to load into our Global Environment, by default R will look in a certain spot in our device: the working directionary. By default, the working directionary is the same spot where our R script is saved. The path to the working directionary can be found by using <code>getwd()</code>. If we want to specify a different workign directionary, for instance because our data is in a folder separate from our codes, we can use <code>setwd()</code>, specifying the path to the directionary.</p>
</section>
<section id="file" class="level3">
<h3 class="anchored" data-anchor-id="file">File</h3>
<p>All methods of reading data require an argument <code>file</code> (sometimes called <code>path</code> or <code>data_file</code>), which <code>?base::load()</code> defines as <em>a (readable binary-mode) connection or a character string giving the name of the file to load (when tilde expansion is done)</em>. This file is simply a path to the document we want to load in. For example: <code>C:/users/username/documents/rtutorial/data/definitely_real_data.csv</code>. Note that the <code>file</code> argument must always end in the file name (<em>definitely_real_data</em>) including extension (<em>.csv</em>).</p>
</section>
<section id="tilde-expansion" class="level3">
<h3 class="anchored" data-anchor-id="tilde-expansion">Tilde expansion</h3>
<p>Remembering where all your data is stored and writing it all out (<code>C:/users/username/...</code>) can cost quite some effort. Luckily, we have a concept called <em>tilde expansion</em>. When we set our working directionary with <code>setwd()</code>, we can stop specifying that part in the <code>file</code> argument and instead only specify a tilde (<em>~</em>). Instead of calling <code>C:/users/username/documents/rtutorial</code>, we can set our working directionary to the documents folder:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">setwd</span>(<span class="st">"C:/users/username/documents/rtutorial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Subsequently, we can specify any <code>file</code> argument as <code>~/data/definitely_real_data.csv</code>.</p>
</section>
</section>
<section id="delimited-data-with-base-and-readr" class="level2">
<h2 class="anchored" data-anchor-id="delimited-data-with-base-and-readr">Delimited data with {base} and {readr}</h2>
<p>Data is often shared in a .csv format, which stands for Comma Separated Values. If we were to open this file in a normal text editor, we would see that each column of a row is separated by a comma between the values. This is a form of delimited data, where there is a certain character (comma, semicolon, tab) that allows the computer to discern between columns. To read such data, we can use different functions from <code>{base}</code>:</p>
<ul>
<li><p><code>read.csv()</code> allows the reading in of data separated with commas where decimal markers are dots</p></li>
<li><p><code>read.csv2()</code> allows the reading in of data separated with semicolons where decimal markers are commas</p></li>
<li><p><code>read.delim()</code> allows the reading in of data separated with tabs where decimal markers are dots</p></li>
<li><p><code>read.delim2()</code> allows the reading in of data separated with tabs where decimal markers are commas</p></li>
</ul>
<p>These functions only differ in the defaults: if you specify arguments such as sep and dec, they can perform the same actions. When using these functions, the data will be read into R, and we can immediately load it into an object which will create a data frame:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/data/definitely_real_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A great alternative to the <code>{base}</code> functions are the functions from <code>{readr}</code>, which are in general faster and treat the data better. The functions have similar names and functionality:</p>
<ul>
<li><p><code>read_csv()</code> allows the reading in of data separated with commas where decimal markers are dots</p></li>
<li><p><code>read_csv2()</code> allows the reading in of data separated with semicolons where decimal markers are commas</p></li>
<li><p><code>read_tsv()</code> allows the reading in of data separated with tabs</p></li>
</ul>
<p>If you want to write these data back into a delimited file, we can use the <code>write</code> functions with similar names, besides replacing read with write:</p>
<ul>
<li><p><code>write.csv()</code> allows the writing of data separated with commas where decimal markers are dots</p></li>
<li><p><code>write_csv()</code> allows the writing of data separated with commas where decimal markers are dots (but faster than <code>write.csv()</code>)</p></li>
<li><p>etc.</p></li>
</ul>
<p>In the writing functions, we first specify the object we want to write to our device and then the path:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">write_csv</span>(iris, <span class="st">"~/data/iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="excel-files" class="level2">
<h2 class="anchored" data-anchor-id="excel-files">Excel files</h2>
<p>If the data is not supplied in a delimited format, but Excel (.xlsx/.xls), we can use the <code>{readxl}</code> package to read in the data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Load first sheet of Excel file</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/data/definitely_real_data.xlsx"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Load third sheet of Excel file</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/data/definitely_real_data.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Using the function <code>read_excel()</code> automatically determines whether the data is stored in .xlsx or .xls and therefore whether it should use <code>read_xlsx()</code> or <code>read_xls()</code>.</p>
<p>If we then want to write data back to Excel, we can use the <code>{writexl}</code> package:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">write_xlsx</span>(iris, <span class="st">"~/data/iris.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="spss-sas-and-stata-data" class="level2">
<h2 class="anchored" data-anchor-id="spss-sas-and-stata-data">SPSS, SAS, and Stata data</h2>
<p>If the data are already formatted for other statistical software, specifically SPSS (.sav, .zsav, and .por), SAS (.sas7bdat) or Stata (.dta, .xpt), we can use <code>{haven}</code> to read these data:</p>
<ul>
<li><p><code>read_spss()</code> can read SPSS files and automatically detects whether a file is .sav/.zsav or .por to use the correct alternative (<code>read_sav()</code> or <code>read_por()</code>).</p></li>
<li><p><code>write_sav()</code> creates an SPSS .sav file (or .zsav if <code>compress = TRUE</code>).</p></li>
<li><p><code>read_sas()</code> reads in SAS .sas7bdat files.</p></li>
<li><p><code>read_xpt()</code>reads in SAS transport .xpt files.</p></li>
<li><p><code>write_sas()</code> is a deprecated function and does not perform reliabily. An alternative is the <code>write_xpt()</code> function to write an R object to a SAS transport (.xpt) file.</p></li>
<li><p><code>read_dta()</code> allows reading of Stata .dta files.</p></li>
<li><p><code>write_dta()</code> writes an R object to a Stata .dta file.</p></li>
</ul>
</section>
<section id="foreign" class="level2">
<h2 class="anchored" data-anchor-id="foreign">Foreign</h2>
<p>If we have data that cannot be loaded in with any of the above functions, we can always have a look whether <code>{foreign}</code> has any functions that can read in the data. <code>{foreign}</code> offers functions for the reading of files such as .ssd, .dbf, .arff, .epiinfo, and more.</p>
</section>
<section id="making-your-life-easier" class="level2">
<h2 class="anchored" data-anchor-id="making-your-life-easier">Making your life easier</h2>
<section id="point-and-click-import" class="level3">
<h3 class="anchored" data-anchor-id="point-and-click-import">Point-and-click import</h3>
<p>Of course it’s nice that all these functions exist to read in your data, but they do not let us preview what the data is going to look like. If we want to preview the data before reading it, in RStudio, we can go to the menu bar, click File and then Import Dataset (<a href="#fig-import">Figure&nbsp;1</a>):</p>
<div id="fig-import" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/import.png" style="height:70.0%" alt="import" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Import data</figcaption><p></p>
</figure>
</div>
<p>From there, we can choose the type of data to import (e.g., Excel) and we will be presented with a viewer (<a href="#fig-viewer">Figure&nbsp;2</a>). In the upper right corner of the viewer, we can select our data with ‘Browse’, which then shows how the data will look like after import. In the lower left corner, we can adjust some options. Lastly, in the lower right corner, we see the code that will be run to read this data into our Global Enviroment. Once happy with how the data will look upon import, we can press ‘Import’ and the data will be imported. You can then copy the code from the console to add it to your script so that you do not need to repeat this step again.</p>
<div id="fig-viewer" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/viewer.png" class="img-fluid figure-img" alt="data-viewer"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Preview of import</figcaption><p></p>
</figure>
</div>
</section>
<section id="rio" class="level3">
<h3 class="anchored" data-anchor-id="rio">Rio</h3>
<p>If we do not want to think about what function to use at all, we can use the R Input/Output package <code>{rio}</code>, which provides the functions <code>import()</code> and <code>export()</code>. These functions automatically recognize the format of the file and choose the correct method of reading in the data. Additionally, <code>{rio}</code> allows us to read and write directly from and to .zip files.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Import data</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">import</span>(<span class="st">"iris.xlsx"</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Export data</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">export</span>(iris, <span class="st">"iris.tsv.zip"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="rdata-and-.rda" class="level2">
<h2 class="anchored" data-anchor-id="rdata-and-.rda">.Rdata and .Rda</h2>
<p>While working on our analyses, we might come across moments where we want to save some object because it took a long time to create. Or a colleague sent us their data straight from R. In this case, we are working with Rdata files (.Rdata, .Rda). These files are easiest to load into R and export out of R with two specific functions:</p>
<ul>
<li><p><code>load()</code> loads the specified file into R.</p></li>
<li><p><code>save()</code> saves an objects onto the device.</p></li>
</ul>
<p>When we load R data files, we do not need to assign them to an object: the object is stored in the file and automatically restored into the Global Environment. For instance:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Save iris to current working directionary</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">save</span>(iris, <span class="at">file =</span> <span class="st">"~/iris.Rdata"</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Load iris</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">load</span>(<span class="st">"iris.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="projectiles-and-carpeting" class="level2">
<h2 class="anchored" data-anchor-id="projectiles-and-carpeting">Projectiles and carpeting</h2>
<section id="arrow-formerly-known-as-feather" class="level3">
<h3 class="anchored" data-anchor-id="arrow-formerly-known-as-feather">Arrow (formerly known as Feather)</h3>
<p>Sometimes we might work with files that take a considerable time to process. In such cases, we might prefer alternatives to .csv files and .Rdata files to work with our data faster. In this case, .arrow files come in handily. These files, formerly known as Feather files, are a special memory format that works across any programming language, organized for efficient operations. Working with .arrow files is supported by the <code>{Arrow}</code> package. A quick start to working with Arrow can be found <a href="https://arrow.apache.org/docs/r/">here</a>.</p>
</section>
<section id="parquet" class="level3">
<h3 class="anchored" data-anchor-id="parquet">Parquet</h3>
<p>Although fast data is nice, sometimes we just want our data to take up less space. Whereas .arrow files focus on speed, .parquet files focus on efficient data storage and retrieval. Working with .parquet files is also supported by the <code>{Arrow}</code> package and a quick start can again be found <a href="https://arrow.apache.org/docs/r/">here</a>.</p>
</section>
</section>
<section id="sql" class="level2">
<h2 class="anchored" data-anchor-id="sql">SQL</h2>
<p>Sometimes, our data is not stored in a local document, but on a server, such as a SQL (Structured Query Language) server. We can call directly to SQL from R and load data into our Global Environment using <code>{RODBC}</code>, which allows general database access. You can connect to the database with <code>odbcConnect()</code> and then pass SQL queries into data using <code>sqlQuery()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sqlQuery</span>(<span class="fu">odbcConnect</span>(<span class="st">"database"</span>), <span class="st">"select * from DATA.DATA_THAT_IS_DEFINITELY_REAL where SEX LIKE 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<section id="downloading-data" class="level3">
<h3 class="anchored" data-anchor-id="downloading-data">0. Downloading data</h3>
<p>For these exercises, we will work with some freely available data that you can download <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1145026/State_funded_schools_inspections_and_outcomes_as_at_31_December_2022.csv">here</a>. If the link does not work, you can look for the file <em>State funded schools inspections and outcomes as at 31 December 2022</em> <a href="https://www.gov.uk/government/statistics/state-funded-schools-inspections-and-outcomes-as-at-31-december-2022">here</a>.</p>
</section>
<section id="loading-new-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-new-data">1. Loading new data</h3>
<p>Load the data you just downloaded into a variable called <code>dat</code>.</p>
<div class="cell">
<details>
<summary>Answer</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"rio"</span>, <span class="st">"readr"</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Define file so that I only have to type it once for each example</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>file <span class="ot">&lt;-</span> <span class="st">"C:/users/rjjan/downloads/State_funded_schools_inspections_and_outcomes_as_at_31_December_2022.csv"</span></span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Answer 1: using import</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>dat <span class="ot">&lt;-</span> <span class="fu">import</span>(file)</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co"># Answer 2: using read_csv</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># suppressWarnings and show_col_types = FALSE for clean output</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>dat <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">read_csv</span>(file, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>))</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Answer 3: using read.csv</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="storing-data" class="level3">
<h3 class="anchored" data-anchor-id="storing-data">2. Storing data</h3>
<p>Now save the data to a file called <em>example_data.Rdata</em>.</p>
<div class="cell">
<details>
<summary>Answer</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Answer 1: use save()</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">save</span>(dat, <span class="at">file =</span> <span class="st">"example_data.Rdata"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># Answer 2: use export()</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">export</span>(dat, <span class="st">"example_data.Rdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="next-topic" class="level2">
<h2 class="anchored" data-anchor-id="next-topic">Next topic</h2>
<p>Now that we know are armed with the power of packages and the ability to load data, let’s explore one of the most famous packages for R: the Tidyverse!</p>
<p><strong>Next:</strong> <a href="./tidyverse.html">Tidyverse</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>